<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Blood Pressure Centiles SMART Application</title>
        
        <!-- BPC stylesheets-->
        <link rel="stylesheet" href="css/bpc-print.css" type="text/css" />
        
        <!-- SMART Connector -->
        <script src="../smart/scripts/smart-api-client.js" type="text/javascript"></script>
        
        <!-- Standard JS Libraries -->
        <script src="js/lib/jquery.js" type="text/javascript"></script>
        <script src="js/lib/jquery-jtemplates.js" type="text/javascript"></script>
        <script src="js/lib/jquery.validate.min.js" type="text/javascript"></script>
        <script src="js/lib/jquery-ui.js" type="text/javascript"></script>
        <script src="js/lib/raphael.js" type="text/javascript"></script>
        <script src="js/lib/xdate.js" type="text/javascript"></script>
        
        <!-- BPC Utilities -->
        <script src="js/cdc_height_tables.js" type="text/javascript"></script>
        <script src="js/nih_bp_tables.js" type="text/javascript"></script>
        <script src="js/util.js" type="text/javascript"></script>
        <script src="js/popup.js" type="text/javascript"></script> 
        
        <!-- BPC App Modules -->
        <script src="js/bpc-config.js" type="text/javascript"></script>
        <script src="js/bpc-data.js" type="text/javascript"></script>
        <script src="js/bpc-filters.js" type="text/javascript"></script>
        <script src="js/bpc-graph.js" type="text/javascript"></script>
        <!--script src="js/bpc-ui.js" type="text/javascript"></script-->
        
        <!-- BPC Print-specific scripts -->
        <script src="js/print/bpc-constants.js" type="text/javascript"></script>
        <script src="js/print/bpc-graph.js" type="text/javascript"></script>
        <script src="js/bpc-print.js" type="text/javascript"></script>
    </head>
    <body>
		<div id="wrap">
			<div id="header"></div>
			
			<table width="100%" border="0" cellspacing="0" cellpadding="0">
				<tr>
					<td width="100%">
						<div id="short-graph"></div>
					</td>
					<td align="right" id="short-table-view" style="padding-left:2em"></td>
				</tr>
			</table>
			
			<!--div class="page-break"></div-->
			
			<div style="margin:1ex;" id="long-graph"></div>
			
			<div id="table-view"></div>
			<br />
			<br />
		</div>
		
		<!-- jTemplates templates -->
        <div style="display:none">
			
			<!-- Header -->
			<textarea id="header-template" rows="0" cols="0"><!--
				{#template MAIN}
					<table id="header-table">
						<tr>
							<td rowspan="5" width="100%">
								<h1>{$T.name}</h1>
								<h2>BP Centiles Report</h2>
							</td>
							<th></th>
							<td>{$T.date}</td>
						</tr>
						<tr>
							<th>gender</th>
							<td>{$T.sex}</td>
						</tr>
						<tr>
							<th>dob</th>
							<td>{$T.dob}</td>
						</tr>
						<tr>	
							<th>height</th>
							<td>
								{#if $T.lastHeight}
									{$T.lastHeight}
									<span class="grey-4">on</span>  
									{$T.lastHeightDate}
								{#/if}
							</td>
						</tr>
						<tr>	
							<th>mrn</th>
							<td style="color:red">99912345</td>
						</tr>
						<tr>
						  <td colspan="3">&nbsp;</td>
						</tr>
						<tr>
							<td colspan="3">last BP on most recent 3 clinic days in mmhg</td>
						</tr>
					</table>
				{#/template MAIN}
			--></textarea>
			
			<textarea id="template" rows="0" cols="0"><!--
            {#template MAIN}
                <table style="width:100%;" border="0" cellspacing="0" cellpadding="0">
                    <thead>
                        {#include HEAD}
                    </thead>
                    <tbody>
                        {#foreach $T.data as record}
                            {#include ROW root=$T.record}
                        {#/for}
                    </tbody>
                </table>
            {#/template MAIN}
            
            {#template HEAD}
                <tr>
                    <td></td>
                    <td></td>
                    <td class="grey-4 small">systolic</td>
                    <td class="grey-4 small">diastolic</td>
                    <td class="grey-4 small">notes</td>
                </tr>
            {#/template HEAD}
            
            {#template ROW}
				{#if $T.sPercentile >= 90}
				<tr class="bg-grey-7">
					<td><b>&#x0039F;</b></td>
				{#elseif $T.dPercentile >= 90}
				<tr class="bg-grey-7">
					<td><b>&#x0039F;</b></td>
				{#else}
				<tr>
					<td></td>
				{#/if}
                    <td>
						{#if $T.unixTime}{new XDate($T.unixTime).toString('d MMM yy')}{#/if}
						<span class="grey-4 small">
							{BPC.getYears($T.age)}y {BPC.getMonths($T.age)}m
						</span>
					</td>
                    <td><b class="grey-1">{$T.systolic}</b> &bull; {$T.sPercentile}%</td>
                    <td><b class="grey-1">{$T.diastolic}</b> &bull; {$T.dPercentile}%</td>
                    <td class="small">
						{#if $T.site}{$T.site}
						{#if $T.position}, {$T.position}
						{#if $T.method}, {$T.method}
					</td>
                </tr>
            {#/template ROW}
        --></textarea></div>
    </body>
</html>
